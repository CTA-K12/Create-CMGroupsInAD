<#	
	.NOTES
	===========================================================================
	 Created with: 	SAPIEN Technologies, Inc., PowerShell Studio 2019 v5.6.163
	 Created on:   	5/17/2019 3:39 PM
	 Created by:   	Eden Nelson
	 Organization: 	Cascade Technology Alliance
	 Filename:     	Create-CMGroupsInAD.ps1
	===========================================================================
	.DESCRIPTION
		A description of the file.
#>
Import-Module ActiveDirectory

$rootDN = [ADSI]"LDAP://RootDSE"; $rootDN = $rootDN.rootDomainNamingContext
$softwareDistrobutionDN = 'OU=Software Distribution,', "$rootDN" -join ''
$csvpath = "C:\Scripts\Create-CMGroupsInAD\Groups.csv"
Remove-Item -Path $csvpath
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/CascadeTechnologyAlliance/Create-CMGroupsInAD/master/Groups.csv" -UseBasicParsing | Select-Object -ExpandProperty Content | Out-File $csvpath
$AllGroups = Import-Csv -Path $csvpath

foreach ($Group in $AllGroups) {
	$Group = $Group.Group
	if (-not (Get-ADGroup -Filter { name -like $Group } -SearchBase $softwareDistrobutionDN -ErrorAction SilentlyContinue)) {
		New-ADGroup -Path $softwareDistrobutionDN -Name $Group -GroupScope Global -GroupCategory Security
	}
}


# SIG # Begin signature block
# MIIQuAYJKoZIhvcNAQcCoIIQqTCCEKUCAQExDzANBglghkgBZQMEAgEFADB5Bgor
# BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG
# KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAbOA1FjL7xao6z
# idKvvW8F15/FNEkz2mqv1Rz76oIjxKCCC8UwggMGMIIB7qADAgECAhAvm0sjSQH3
# m0LSdEnNXu4qMA0GCSqGSIb3DQEBBQUAMBYxFDASBgNVBAMMC0VkZW4gTmVsc29u
# MB4XDTE3MDkwODIyMjY1MVoXDTM3MDkwODIyMzY1MVowFjEUMBIGA1UEAwwLRWRl
# biBOZWxzb24wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC3lMKGVj2k
# Rlf/d9ZWmJoqLDG+hqkThaS+TF8uiPwsnFkIEkjjJaMoLIV+5mk1OQvZxHajtLgi
# SnVXEkCUdrSagfbsDgJ3pYPEA8WSx/IQ1j5oWl9lIwIuqXyRCD1vMwPHJb7kuviv
# a05fczHTcd4Iuj2XdrHcacUntSsUQxEW+JpkzEOUVPhxSYdB8vZZoW+I/pt9FPf6
# MuzcolbK4RWCuyCDh9kASJOj+e4LZF19PTSCypVPOuDUXI92cTjcxNyiMcSJEnXg
# ZFEURT8Jfw+e0Yq9R/6oCWnYZgMGD9iYEQku0XG8KjVWNrugO5sqdw89ZQqYDzlZ
# e0NSwcTliiGRAgMBAAGjUDBOMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggr
# BgEFBQcDAgYIKwYBBQUHAwEwHQYDVR0OBBYEFBCaND0z/gTu/Cbsm3UxQIbh/je7
# MA0GCSqGSIb3DQEBBQUAA4IBAQAIeQRrB23zdZpDymoDE52GN2v9N5Uu3cgkUz9k
# 788n3LfuQnhBdDSGXi2ZhUX2kXyas/F0tE0uEYxWb6NDwA8qYBSl7AWL+hEA2mkb
# a7Dj3p6KRyKkHsiPAY0BSu7hZypZ8oC19Y2uXYcUQymfJ4jg2sZkpfEL4JM5XXTZ
# KpWrY7bGIqu8VJH40j3EJg1dcG0SsTDtyoYxoc921zRMztygYe9tLya6gl0zy1Qt
# rKOLu+Q8pHsP8dcSest7QNL8xEYdE92qAa7LPwzwhVSU168LoYRiu64FD8P80ZOH
# ARN5U3JqQjDqsx5FJeY9XdFDXtKTU55pQvPID9Wjn6D2MLo3MIIEFDCCAvygAwIB
# AgILBAAAAAABL07hUtcwDQYJKoZIhvcNAQEFBQAwVzELMAkGA1UEBhMCQkUxGTAX
# BgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsTB1Jvb3QgQ0ExGzAZBgNV
# BAMTEkdsb2JhbFNpZ24gUm9vdCBDQTAeFw0xMTA0MTMxMDAwMDBaFw0yODAxMjgx
# MjAwMDBaMFIxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWduIG52LXNh
# MSgwJgYDVQQDEx9HbG9iYWxTaWduIFRpbWVzdGFtcGluZyBDQSAtIEcyMIIBIjAN
# BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlO9l+LVXn6BTDTQG6wkft0cYasvw
# W+T/J6U00feJGr+esc0SQW5m1IGghYtkWkYvmaCNd7HivFzdItdqZ9C76Mp03otP
# DbBS5ZBb60cO8eefnAuQZT4XljBFcm05oRc2yrmgjBtPCBn2gTGtYRakYua0QJ7D
# /PuV9vu1LpWBmODvxevYAll4d/eq41JrUJEpxfz3zZNl0mBhIvIG+zLdFlH6Dv2K
# MPAXCae78wSuq5DnbN96qfTvxGInX2+ZbTh0qhGL2t/HFEzphbLswn1KJo/nVrqm
# 4M+SU4B09APsaLJgvIQgAIMboe60dAXBKY5i0Eex+vBTzBj5Ljv5cH60JQIDAQAB
# o4HlMIHiMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1Ud
# DgQWBBRG2D7/3OO+/4Pm9IWbsN1q1hSpwTBHBgNVHSAEQDA+MDwGBFUdIAAwNDAy
# BggrBgEFBQcCARYmaHR0cHM6Ly93d3cuZ2xvYmFsc2lnbi5jb20vcmVwb3NpdG9y
# eS8wMwYDVR0fBCwwKjAooCagJIYiaHR0cDovL2NybC5nbG9iYWxzaWduLm5ldC9y
# b290LmNybDAfBgNVHSMEGDAWgBRge2YaRQ2XyolQL30EzTSo//z9SzANBgkqhkiG
# 9w0BAQUFAAOCAQEATl5WkB5GtNlJMfO7FzkoG8IW3f1B3AkFBJtvsqKa1pkuQJkA
# VbXqP6UgdtOGNNQXzFU6x4Lu76i6vNgGnxVQ380We1I6AtcZGv2v8Hhc4EvFGN86
# JB7arLipWAQCBzDbsBJe/jG+8ARI9PBw+DpeVoPPPfsNvPTF7ZedudTbpSeE4zib
# i6c1hkQgpDttpGoLoYP9KOva7yj2zIhd+wo7AKvgIeviLzVsD440RZfroveZMzV+
# y5qKu0VN5z+fwtmK+mWybsd+Zf/okuEsMaL3sCc2SI8mbzvuTXYfecPlf5Y1vC0O
# zAGwjn//UYCAp5LUs0RGZIyHTxZjBzFLY7Df8zCCBJ8wggOHoAMCAQICEhEh1pmn
# ZJc+8fhCfukZzFNBFDANBgkqhkiG9w0BAQUFADBSMQswCQYDVQQGEwJCRTEZMBcG
# A1UEChMQR2xvYmFsU2lnbiBudi1zYTEoMCYGA1UEAxMfR2xvYmFsU2lnbiBUaW1l
# c3RhbXBpbmcgQ0EgLSBHMjAeFw0xNjA1MjQwMDAwMDBaFw0yNzA2MjQwMDAwMDBa
# MGAxCzAJBgNVBAYTAlNHMR8wHQYDVQQKExZHTU8gR2xvYmFsU2lnbiBQdGUgTHRk
# MTAwLgYDVQQDEydHbG9iYWxTaWduIFRTQSBmb3IgTVMgQXV0aGVudGljb2RlIC0g
# RzIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCwF66i07YEMFYeWA+x
# 7VWk1lTL2PZzOuxdXqsl/Tal+oTDYUDFRrVZUjtCoi5fE2IQqVvmc9aSJbF9I+MG
# s4c6DkPw1wCJU6IRMVIobl1AcjzyCXenSZKX1GyQoHan/bjcs53yB2AsT1iYAGvT
# FVTg+t3/gCxfGKaY/9Sr7KFFWbIub2Jd4NkZrItXnKgmK9kXpRDSRwgacCwzi39o
# gCq1oV1r3Y0CAikDqnw3u7spTj1Tk7Om+o/SWJMVTLktq4CjoyX7r/cIZLB6RA9c
# ENdfYTeqTmvT0lMlnYJz+iz5crCpGTkqUPqp0Dw6yuhb7/VfUfT5CtmXNd5qheYj
# BEKvAgMBAAGjggFfMIIBWzAOBgNVHQ8BAf8EBAMCB4AwTAYDVR0gBEUwQzBBBgkr
# BgEEAaAyAR4wNDAyBggrBgEFBQcCARYmaHR0cHM6Ly93d3cuZ2xvYmFsc2lnbi5j
# b20vcmVwb3NpdG9yeS8wCQYDVR0TBAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcD
# CDBCBgNVHR8EOzA5MDegNaAzhjFodHRwOi8vY3JsLmdsb2JhbHNpZ24uY29tL2dz
# L2dzdGltZXN0YW1waW5nZzIuY3JsMFQGCCsGAQUFBwEBBEgwRjBEBggrBgEFBQcw
# AoY4aHR0cDovL3NlY3VyZS5nbG9iYWxzaWduLmNvbS9jYWNlcnQvZ3N0aW1lc3Rh
# bXBpbmdnMi5jcnQwHQYDVR0OBBYEFNSihEo4Whh/uk8wUL2d1XqH1gn3MB8GA1Ud
# IwQYMBaAFEbYPv/c477/g+b0hZuw3WrWFKnBMA0GCSqGSIb3DQEBBQUAA4IBAQCP
# qRqRbQSmNyAOg5beI9Nrbh9u3WQ9aCEitfhHNmmO4aVFxySiIrcpCcxUWq7GvM1j
# jrM9UEjltMyuzZKNniiLE0oRqr2j79OyNvy0oXK/bZdjeYxEvHAvfvO83YJTqxr2
# 6/ocl7y2N5ykHDC8q7wtRzbfkiAD6HHGWPZ1BZo08AtZWoJENKqA5C+E9kddlsm2
# ysqdt6a65FDT1De4uiAO0NOSKlvEWbuhbds8zkSdwTgqreONvc0JdxoQvmcKAjZk
# iLmzGybu555gxEaovGEzbM9OuZy5avCfN/61PU+a003/3iCOTpem/Z8JvE3KGHbJ
# sE2FUPKA0h0G9VgEB7EYMYIESTCCBEUCAQEwKjAWMRQwEgYDVQQDDAtFZGVuIE5l
# bHNvbgIQL5tLI0kB95tC0nRJzV7uKjANBglghkgBZQMEAgEFAKBMMBkGCSqGSIb3
# DQEJAzEMBgorBgEEAYI3AgEEMC8GCSqGSIb3DQEJBDEiBCBL0FuqNYFAJO124V+p
# KYJmY28i2SsiNLAe8ngCIOUgTzANBgkqhkiG9w0BAQEFAASCAQByIKOWvyvdGRVO
# R+iMwCIknutMP6h+zZGwKC7q1Y7A1tbhePxlY+B0kYDhOpAnne3JmoQBrYXY0AVo
# Oj7SKyXwkqp4AvRT77KiniON8LSXRCk5u3Kc8OdX5PXEHsse7aiHMirHsUhoqBbU
# kkmWk0HRVmGD2l+bZY6UF0J5bS4Mby4ufP9eaDOrPdGYPDM1NXExEtedKmbWairv
# ialX0yF9PHNd8Cnk0581tO4CJdNr/g2qYpdmvXR9dhT3GSdGY8uF4OzItLrOPzNn
# RLSlE+th8Tv4JfUMlOXn/R9EKZ4GtmEV/82JTNF1q0OqfINCZNoL+RjouIBOU23E
# 03L8JtvdoYICojCCAp4GCSqGSIb3DQEJBjGCAo8wggKLAgEBMGgwUjELMAkGA1UE
# BhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExKDAmBgNVBAMTH0dsb2Jh
# bFNpZ24gVGltZXN0YW1waW5nIENBIC0gRzICEhEh1pmnZJc+8fhCfukZzFNBFDAJ
# BgUrDgMCGgUAoIH9MBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcN
# AQkFMQ8XDTE5MDUyMDE3NDMwN1owIwYJKoZIhvcNAQkEMRYEFDG8nmHRhEGjtx7t
# 49EyQNpyAIPsMIGdBgsqhkiG9w0BCRACDDGBjTCBijCBhzCBhAQUY7gvq2H1g5CW
# lQULACScUCkz7HkwbDBWpFQwUjELMAkGA1UEBhMCQkUxGTAXBgNVBAoTEEdsb2Jh
# bFNpZ24gbnYtc2ExKDAmBgNVBAMTH0dsb2JhbFNpZ24gVGltZXN0YW1waW5nIENB
# IC0gRzICEhEh1pmnZJc+8fhCfukZzFNBFDANBgkqhkiG9w0BAQEFAASCAQAzAc66
# 6d72Fla80IqIJmg/azWa+m7hruwh6QHoEQQh2iUwKMqOUekq9yRhu/8ILwIyggi+
# ZEs1yTM6EtiN3ZJiU2qBOh0QLOyqrxjWH/rfn6t0VXkl0ksYohedevCtlgkdj7gu
# WLXcV46EuIIGB/AwFeeBJMmdLnHPSJ60y52Chdfrxqf07jD/6QJAVUYp1XUlN93T
# WNfTXBQYXUH+d2sN7vYbNYaYbqWXZzHYM3tqU+GVbYgvMtG4M2ObUKGcmSsNo895
# K605s0Cbl5n7df3UlHNgV+wN/LTe16O3lbDbqZ2ZjyUmsmLymeEWvf5cBmKO/cN0
# pEM4SevKnQuEi+Yz
# SIG # End signature block
